{"version":3,"file":"datebook.min.js","sources":["../../src/constants.ts","../../src/utils/time.ts","../../src/CalendarBase.ts","../node_modules/tslib/tslib.es6.js","../../src/utils/data.ts","../../src/utils/ics.ts","../../src/GoogleCalendar.ts","../../src/YahooCalendar.ts","../../src/OutlookCalendar.ts","../../src/ICalendar.ts"],"sourcesContent":["export const RECURRENCE = {\n  FREQUENCY: {\n    DAILY: 'DAILY',\n    WEEKLY: 'WEEKLY',\n    MONTHLY: 'MONTHLY',\n    YEARLY: 'YEARLY'\n  }\n}\n\nexport const FORMAT = {\n  DATE: 'YYYYMMDD',\n  TIME: 'ThhmmssZ',\n  FULL: 'YYYYMMDDThhmmssZ',\n  NO_UTC_FULL: 'YYYYMMDDThhmmss',\n  OUTLOOK_DATE: 'YYYY-MM-DD',\n  OUTLOOK_TIME: 'Thh:mm:ssZ',\n  OUTLOOK_FULL: 'YYYY-MM-DDThh:mm:ssZ'\n}\n\nexport const URL = {\n  YAHOO: 'https://calendar.yahoo.com/',\n  GOOGLE: 'https://calendar.google.com/calendar/render',\n  OUTLOOK: 'https://outlook.{{host}}.com/calendar/action/compose'\n}\n","import { RECURRENCE, FORMAT } from '../constants'\nimport CalendarRecurrence from '../types/CalendarRecurrence'\n\n/**\n * Adds a leading zero to a single-digit string and returns a two-digit string.\n *\n * @param {number | string} n\n * @returns {string}\n */\nconst addLeadingZero = (n: number | string = ''): string => {\n  return `0${parseInt(n.toString(), 10)}`.slice(-2)\n}\n\n/**\n * Returns the duration between two given dates in hhmm format.\n *\n * @param {number} start\n * @param {number} end\n * @returns {string}\n */\nconst getDuration = (start: number, end: number): string => {\n  const seconds = Math.floor((end - start) / 1000)\n  const hours = Math.floor(seconds / 3600)\n  const mins = ((seconds / 3600) % 1) * 60\n\n  return `${addLeadingZero(hours)}${addLeadingZero(mins)}`\n}\n\n/**\n * Returns the number of hours between two given dates.\n *\n * @param {number} start\n * @param {number} end\n * @returns {number}\n */\nconst getHoursDiff = (start: number, end: number): number => {\n  const seconds = Math.floor((end - start) / 1000)\n\n  return Math.floor(seconds / 3600)\n}\n\n/**\n * Computes the number of days a recurrence will last.\n *\n * @param {CalendarRecurrence} recurrence\n * @returns {number}\n */\nconst getRecurrenceLengthDays = (recurrence: CalendarRecurrence): number => {\n  const { frequency, interval } = recurrence\n  const { FREQUENCY } = RECURRENCE\n\n  if (interval) {\n    switch (frequency) {\n      case FREQUENCY.YEARLY:\n        return interval * 365.25\n      case FREQUENCY.MONTHLY:\n        return interval * 30.42 // avg days in a year\n      case FREQUENCY.WEEKLY:\n        return interval * 7\n      default:\n        return interval // daily\n    }\n  }\n\n  // if no frequency is specified, set an arbitrarily-long recurrence end\n  return 365.25 * 100 // 100 years\n}\n\n/**\n * Formats the given JS Date() object to the given format.\n * Format defaults to: YYYYMMDDTHHMMss\n *\n * @param {Date} [d = new Date()]\n * @param {string} format\n * @returns {string}\n */\nconst formatDate = (d: Date = new Date(), format: string): string => {\n  const dateValues: Record<string, string | number> = {\n    YYYY: d.getUTCFullYear(),\n    MM: addLeadingZero(d.getUTCMonth() + 1),\n    DD: addLeadingZero(d.getUTCDate()),\n    hh: addLeadingZero(d.getUTCHours()),\n    mm: addLeadingZero(d.getUTCMinutes()),\n    ss: addLeadingZero(d.getUTCSeconds())\n  }\n\n  return Object\n    .keys(dateValues)\n    .reduce((date: string, key: string): string => {\n      return date.replace(key, dateValues[key].toString())\n    }, format)\n}\n\n\n/**\n * Formats the given JS Date() object to the given format, not using UTC\n * Format defaults to: YYYYMMDDTHHMMss\n *\n * @param {Date} [d = new Date()]\n * @param {string} format\n * @returns {string}\n */\nconst formatDateNoUtc = (d: Date = new Date(), format: string): string => {\n  const dateValues: Record<string, string | number> = {\n    YYYY: d.getFullYear(),\n    MM: addLeadingZero(d.getMonth() + 1),\n    DD: addLeadingZero(d.getDate()),\n    hh: addLeadingZero(d.getHours()),\n    mm: addLeadingZero(d.getMinutes()),\n    ss: addLeadingZero(d.getSeconds())\n  }\n\n  return Object\n    .keys(dateValues)\n    .reduce((date: string, key: string): string => {\n      return date.replace(key, dateValues[key].toString())\n    }, format)\n}\n\n/**\n * Returns the current timestamp.\n *\n * @returns {string}\n */\nconst getTimeCreated = (): string => {\n  return formatDate(new Date(), FORMAT.FULL)\n}\n\n/**\n * Increments dates by the given number of days.\n * This will account for edge cases, such as leap years.\n *\n * @param {Date} dateInput - date to increment\n * @param {number} days - number of days\n * @returns {Date}\n */\nconst incrementDate = (dateInput: Date, days: number): Date => {\n  const additionalTime = days * 86400000\n  const newDate = new Date()\n\n  newDate.setTime(dateInput.getTime() + additionalTime)\n\n  return newDate\n}\n\nexport default {\n  addLeadingZero,\n  getDuration,\n  getHoursDiff,\n  getRecurrenceLengthDays,\n  formatDate,\n  formatDateNoUtc,\n  getTimeCreated,\n  incrementDate\n}\n","import ICalendarBase from './types/ICalendarBase'\nimport CalendarRecurrence from './types/CalendarRecurrence'\nimport CalendarOptions from './types/CalendarOptions'\nimport time from './utils/time'\nimport CalendarAttendee from './types/CalendarAttendee'\n\n/**\n * Base calendar class. This class can be extended to add new calendar services.\n */\nabstract class CalendarBase implements ICalendarBase {\n  /** True if the event is one that spans the entire day. */\n  protected isAllDay = false\n\n  /** Event description. */\n  protected description = ''\n\n  /** Event title. */\n  protected title = ''\n\n  /** Event physical location. */\n  protected location = ''\n\n  /** Start time of the event. */\n  protected start = new Date()\n\n  /** End time of the event. */\n  protected end = new Date()\n\n  /** Event recurrence specification. See {@link CalendarRecurrence} */\n  protected recurrence?: CalendarRecurrence\n\n  /** Calendar service query string params. */\n  protected params: Record<string, string | null> = {}\n\n  /** Array of event attendees. See {@link CalendarAttendee} */\n  protected attendees: CalendarAttendee[] = []\n\n  /**\n   * Constructor.\n   *\n   * @param {CalendarOptions} options\n   */\n  constructor (options: CalendarOptions) {\n    this.setText(options)\n    this.setTimestamps(options)\n    this.setAttendees(options)\n  }\n\n  /**\n   * Sets the description, title and location.\n   *\n   * @param {CalendarOptions} options\n   */\n  protected setText = (options: CalendarOptions): void => {\n    this.description = options.description || ''\n    this.title = options.title || ''\n    this.location = options.location || ''\n  }\n\n  /**\n   * Sets the time and recurrence parameters.\n   *\n   * @param {CalendarOptions} options\n   */\n  protected setTimestamps = (options: CalendarOptions): void => {\n    this.isAllDay = !options.end\n    this.start = options.start\n\n    // if no end date is specified, make the end date exactly 1 day from the start date\n    this.end = options.end || time.incrementDate(this.start, 1)\n\n    this.recurrence = options.recurrence\n  }\n\n  /**\n   * Sets the attendees array if attendees are supplied.\n   *\n   * @param {CalendarOptions} options\n   */\n  protected setAttendees (options: CalendarOptions): void {\n    this.attendees = Array.isArray(options.attendees) ? options.attendees : []\n  }\n\n  /**\n   * Sets additional calendar service properties.\n   * May be used to override existing query string params if necessary.\n   *\n   * @param {string} key\n   * @param {string | null} value\n   * @returns {CalendarBase}\n   */\n  public setParam = (key: string, value: string | null): this => {\n    this.params[key] = value\n\n    return this\n  }\n\n  /** Sets base query string/ICS params. */\n  protected abstract setInitialParams (): void\n\n  /** Renders the URL/ICS file data. */\n  public abstract render (): string\n}\n\nexport default CalendarBase\n","/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n        desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n\r\nexport function __classPrivateFieldIn(state, receiver) {\r\n    if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\r\n    return typeof state === \"function\" ? receiver === state : state.has(receiver);\r\n}\r\n","import CalendarAttendee from '../types/CalendarAttendee'\n\n/**\n * Creates a param string from a flat key-value pair.\n *\n * @param {Record<string, string>} params\n * @param {string} [delimiter = ';']\n * @param {Function} [transformFn] - transformation function to be applied to each param\n * @returns {string}\n */\nconst toParamString = (\n  params: Record<string, string>,\n  delimiter = ';',\n  transformFn: (s: string) => string = s => s\n): string => {\n  const paramString = []\n\n  for (const key in params) {\n    if (params.hasOwnProperty(key) && params[key] !== undefined) {\n      paramString.push(`${key}=${transformFn(params[key])}`)\n    }\n  }\n\n  return paramString.join(delimiter)\n}\n\n/**\n * Creates a query string from a flat key-value pair.\n *\n * @param {Record<string, string | null>} params\n * @returns {string}\n */\nconst toQueryString = (params: Record<string, string | null>): string => {\n  // filter the record set to remove null values\n  const filteredParams = Object\n    .keys(params)\n    .filter(p => params[p] !== null)\n    .reduce((p: Record<string, string>, k: string) => ({\n      ...p,\n      [k]: params[k] as string\n    }), {})\n\n  return toParamString(filteredParams, '&', encodeURIComponent)\n}\n\n/**\n * Creates an ICS param string from a flat key-value pair.\n *\n * @param {Record<string, string>} params\n * @returns {string}\n */\nconst toIcsParamString = (params: Record<string, string>): string => {\n  return toParamString(params, ';')\n}\n\n/**\n * Renders a comma-separated string of mailto values.\n * (e.g., 'John Doe <john@doe.com>,Jane Doe <jane@doe.com>')\n *\n * @param {CalendarAttendee[]} attendees\n * @returns {string[]}\n */\nconst toMailtoList = (attendees: CalendarAttendee[]): string[] => {\n  return attendees\n    .map(({ email, name }) => {\n      return name\n        ? `${name} <${email}>`\n        : email\n    })\n}\n\n/**\n * Converts the given string to ProperCase.\n *\n * @param {string} s\n * @returns {string}\n */\nconst toProperCase = (s: string): string => {\n  return [\n    s[0].toUpperCase(),\n    s.slice(-s.length + 1).toLowerCase()\n  ].join('')\n}\n\nexport default {\n  toParamString,\n  toQueryString,\n  toIcsParamString,\n  toMailtoList,\n  toProperCase\n}\n","import data from './data'\nimport time from './time'\nimport CalendarRecurrence from '../types/CalendarRecurrence'\nimport { FORMAT } from '../constants'\n\n/**\n * Removes line breaks from a string. Returns an empty string if falsy.\n *\n * @param {string} [str = ''] - string to sanitize\n * @returns {string}\n */\nconst formatText = (str = ''): string => {\n  return str\n    .replace(/\\\\/g, '\\\\\\\\')\n    .replace(/\\n/g, '\\\\n')\n    .replace(/[,;]/g, '\\\\$&')\n}\n\n/**\n * Returns a random base 36 hash for iCal UID.\n *\n * @returns {string}\n */\nconst getUid = (): string => {\n  return Math.random().toString(36).substr(2)\n}\n\n/**\n * Returns the hostname for usage in `PRODID`. Returns `datebook` in Node.js.\n *\n * @returns {string}\n */\nconst getProdId = (): string => {\n  return typeof window !== 'undefined'\n    ? window.location.host\n    : 'datebook'\n}\n\n/**\n * Converts the given recurrence options to RFC????\n *\n * @param {CalendarRecurrence} recurrence\n * @returns {string}\n */\nconst getRrule = (recurrence: CalendarRecurrence): string => {\n  const rrule: Record<string, any> = {\n    FREQ: recurrence.frequency,\n    INTERVAL: recurrence.interval?.toString(),\n    COUNT: recurrence.count?.toString(),\n    WKST: recurrence.weekstart,\n    BYDAY: recurrence.weekdays,\n    BYMONTHDAY: recurrence.monthdays\n  }\n\n  if (recurrence.end) {\n    rrule.UNTIL = time.formatDate(recurrence.end, FORMAT.FULL)\n  }\n\n  return data.toIcsParamString(rrule)\n}\n\nexport default {\n  formatText,\n  getUid,\n  getProdId,\n  getRrule\n}\n","import CalendarBase from './CalendarBase'\nimport data from './utils/data'\nimport ics from './utils/ics'\nimport time from './utils/time'\nimport { FORMAT, URL } from './constants'\nimport CalendarOptions from './types/CalendarOptions'\n\n/**\n * Generates a Google Calendar url.\n */\nexport default class GoogleCalendar extends CalendarBase {\n  constructor (opts: CalendarOptions) {\n    super(opts)\n    this.setInitialParams()\n  }\n\n  /**\n   * Sets the basic properties for the calendar instance.\n   */\n  protected setInitialParams = (): void => {\n    let timestampFormat = FORMAT.DATE\n\n    if (!this.isAllDay) {\n      timestampFormat += FORMAT.TIME\n    }\n\n    const dates = [\n      time.formatDate(this.start, timestampFormat),\n      time.formatDate(this.end, timestampFormat)\n    ].join('/')\n\n    this\n      .setParam('action', 'TEMPLATE')\n      .setParam('dates', dates)\n      .setParam('text', this.title)\n      .setParam('details', this.description)\n      .setParam('location', this.location)\n      .setParam('allday', this.isAllDay.toString())\n\n    if (this.recurrence) {\n      this.setParam('recur', `RRULE:${ics.getRrule(this.recurrence)}`)\n    }\n\n    if (this.attendees.length > 0) {\n      this.setParam('add', data.toMailtoList(this.attendees).join(','))\n    }\n  }\n\n  /**\n   * Generates the Google Calendar url.\n   *\n   * @returns {string}\n   */\n  public render = (): string => {\n    const baseUrl = URL.GOOGLE\n    const queryString = data.toQueryString(this.params)\n\n    return `${baseUrl}?${queryString}`\n  }\n}\n","import CalendarBase from './CalendarBase'\nimport { URL, FORMAT } from './constants'\nimport data from './utils/data'\nimport time from './utils/time'\nimport CalendarOptions from './types/CalendarOptions'\n\n/**\n * Generates a Yahoo! Calendar url.\n *\n * @remark Yahoo! Calendar's support for recurrence is limited to only the interval and frequency.\n */\nexport default class YahooCalendar extends CalendarBase {\n  constructor (opts: CalendarOptions) {\n    super(opts)\n    this.setInitialParams()\n  }\n\n  /**\n   * Sets the basic properties for the calendar instance.\n   */\n  protected setInitialParams = (): void => {\n    this\n      .setParam('v', '60') // version number; must be 60\n      .setParam('title', this.title)\n      .setParam('desc', this.description)\n      .setParam('in_loc', this.location)\n\n    this.setTimeParams()\n\n    if (this.attendees.length > 0) {\n      this.setParam('inv_list', data.toMailtoList(this.attendees).join(','))\n    }\n  }\n\n  /**\n   * Sets the start/end/allday parameters.\n   */\n  private setTimeParams = (): void => {\n    if (this.isAllDay) {\n      this\n        .setParam('dur', 'allday')\n        .setParam('st', time.formatDateNoUtc(this.start, FORMAT.DATE))\n    } else {\n      this.setParam('st', time.formatDateNoUtc(this.start, FORMAT.NO_UTC_FULL))\n\n      if (time.getHoursDiff(this.start.getTime(), this.end.getTime()) > 99) {\n        // Yahoo only supports up to 99 hours, so we are forced to specify the end time instead of the duration\n        this.setParam('et', time.formatDateNoUtc(this.end, FORMAT.NO_UTC_FULL))\n      } else {\n        // we prefer specifying duration in lieu of end time, because apparently Yahoo's end time is buggy w.r.t. timezones\n        this.setParam('dur', time.getDuration(this.start.getTime(), this.end.getTime()))\n      }\n    }\n  }\n\n  /**\n   * Generates the Yahoo! Calendar data.\n   *\n   * @returns {string}\n   */\n  public render = (): string => {\n    const baseUrl = URL.YAHOO\n    const queryString = data.toQueryString(this.params)\n\n    return `${baseUrl}?${queryString}`\n  }\n}\n","import CalendarBase from './CalendarBase'\nimport { FORMAT, URL } from './constants'\nimport data from './utils/data'\nimport time  from './utils/time'\nimport CalendarOptions from './types/CalendarOptions'\n\n/**\n * Generates an Outlook Calendar url.\n *\n * @remark Outlook Calendar's query string params do not support recurrence.\n */\nexport default class OutlookCalendar extends CalendarBase {\n  /** Base URL for the host service. */\n  private baseUrl: string = URL.OUTLOOK\n\n  constructor (opts: CalendarOptions) {\n    super(opts)\n    this.setInitialParams()\n    this.setHost('live')\n  }\n\n  /**\n   * Sets the basic properties for the calendar instance.\n   */\n  protected setInitialParams = (): void => {\n    let timestampFormat = FORMAT.OUTLOOK_DATE\n\n    if (!this.isAllDay) {\n      timestampFormat += FORMAT.OUTLOOK_TIME\n    }\n\n    this\n      .setParam('rru', 'addevent')\n      .setParam('path', '/calendar/action/compose')\n      .setParam('startdt', time.formatDate(this.start, timestampFormat))\n      .setParam('enddt', time.formatDate(this.end, timestampFormat))\n      .setParam('subject', this.title)\n      .setParam('body', this.description)\n      .setParam('location', this.location)\n      .setParam('allday', this.isAllDay.toString())\n\n    if (this.attendees.length > 0) {\n      this.setParam('to', data.toMailtoList(this.attendees).join(','))\n    }\n  }\n\n  /**\n   * Sets the host service type. The default host for Outlook is **`live`**.\n   *\n   * @param {string} host - `live` (for personal accounts) or `office` (for Office365)\n   * @returns {OutlookCalendar}\n   */\n  public setHost = (host: string): this => {\n    if (['live', 'office'].includes(host)) {\n      this.baseUrl = URL.OUTLOOK.replace('{{host}}', host)\n    }\n\n    return this\n  }\n\n  /**\n   * Generates the Outlook url.\n   *\n   * @returns {string}\n   */\n  public render = (): string => {\n    const queryString = data.toQueryString(this.params)\n\n    return `${this.baseUrl}?${queryString}`\n  }\n}\n","import CalendarBase from './CalendarBase'\nimport { FORMAT } from './constants'\nimport data from './utils/data'\nimport ics from './utils/ics'\nimport time from './utils/time'\nimport CalendarOptions from './types/CalendarOptions'\nimport ICSAlarm from './types/ICSAlarm'\nimport ICSAttendeeOptions from './types/ICSAttendeeOptions'\nimport ICSDuration from './types/ICSDuration'\nimport ICSPropertyValue from './types/ICSPropertyValue'\n\n/**\n * Renders ICS file content.\n */\nexport default class ICalendar extends CalendarBase {\n  /** List of additional ICalendar events to add. */\n  private additionalEvents: ICalendar[] = []\n\n  /** List of VEVENT property-value entries */\n  public properties: string[] = []\n\n  /** Key-value pair of basic calendar properties. */\n  private meta: Record<string, string> = {}\n\n  constructor (opts: CalendarOptions) {\n    super(opts)\n    this.setInitialParams()\n  }\n\n  /**\n   * Sets the basic properties for the calendar instance.\n   */\n  protected setInitialParams = (): void => {\n    this\n      .setMeta('UID', ics.getUid())\n      .setMeta('DTSTAMP', time.getTimeCreated())\n      .addProperty('CLASS', 'PUBLIC')\n      .addProperty('DESCRIPTION', ics.formatText(this.description))\n      .addProperty('LOCATION', ics.formatText(this.location))\n      .addProperty('SUMMARY', ics.formatText(this.title))\n      .addProperty('TRANSP', 'TRANSPARENT')\n\n    if (this.isAllDay) {\n      // for all-day events, omit the time and just place dates\n      this\n        .addProperty('DTSTART;VALUE=DATE', time.formatDateNoUtc(this.start, FORMAT.DATE))\n        .addProperty('DTEND;VALUE=DATE', time.formatDateNoUtc(time.incrementDate(this.start, 1), FORMAT.DATE))\n    } else {\n      // otherwise, set the full start and end dates\n      this\n        .addProperty('DTSTART', time.formatDate(this.start, FORMAT.FULL))\n        .addProperty('DTEND', time.formatDate(this.end, FORMAT.FULL))\n    }\n\n    if (this.recurrence) {\n      this.addProperty('RRULE', ics.getRrule(this.recurrence))\n    }\n\n    if (this.attendees.length > 0) {\n      this\n        .attendees\n        .forEach(({ email, name, icsOptions = {} }) => {\n          const params = this.getAttendeeParams(icsOptions, name)\n          const mailto = `MAILTO:${email}`\n\n          this.addProperty(params, mailto)\n        })\n    }\n  }\n\n  /**\n   * Generates the ATTENDEE property param based on user-specified options and the attendee name.\n   *\n   * @param {ICSAttendeeOptions} options\n   * @param {string} name\n   * @returns {string}\n   */\n  private getAttendeeParams = (options: ICSAttendeeOptions, name?: string): string => {\n    const params: Record<string, string> = {}\n\n    if (name) params['CN'] = name\n    if (options.delegatedFrom) params['DELEGATED-FROM'] = options.delegatedFrom\n    if (options.partStat) params['PARTSTAT'] = options.partStat\n    if (options.role) params['ROLE'] = options.role\n    if (options.sentBy) params['SENT-BY'] = options.sentBy\n\n    params['RSVP'] = options.rsvp ? 'TRUE' : 'FALSE'\n\n    const paramString = data.toParamString(params, ';')\n\n    return `ATTENDEE;${paramString}`\n  }\n\n  /**\n   * Generates a valid ICS alarm duration.\n   *\n   * @example getAlarmDuration({ minutes: 3, seconds: 2 }) -> PT3M2S\n   * @param {ICSDuration} duration\n   * @returns {string}\n   */\n  private getAlarmDuration = (duration: ICSDuration): string => {\n    const features = [\n      `${duration.weeks}W`,\n      `${duration.days}D`,\n      `${duration.hours}H`,\n      `${duration.minutes}M`,\n      `${duration.seconds}S`\n    ].filter((s: string) => /^[0-9]+[A-Z]$/.exec(s)) // exclude zero-duration features\n\n    features.unshift(duration.after ? 'PT' : '-PT')\n\n    return features.join('')\n  }\n\n  /**\n   * Returns the iCalendar meta properties, formatted as VEVENT entry lines.\n   *\n   * @returns {string[]}\n   */\n  public getMeta = (): string[] => {\n    return Object\n      .keys(this.meta)\n      .map((key: string) => {\n        return `${key}:${this.meta[key]}`\n      })\n  }\n\n  /**\n   * Sets iCalendar meta properties, such as UID, DTSTAMP, etc.\n   *\n   * @param {string} key\n   * @param {string} value\n   * @returns {ICalendar}\n   */\n  public setMeta = (key: string, value: string): this => {\n    this.meta[key] = value\n\n    return this\n  }\n\n  /**\n   * Adds the given event to the same `.ics` file instance.\n   *\n   * @param {ICalendar} event\n   * @returns {ICalendar}\n   */\n  public addEvent = (event: ICalendar): this => {\n    this.additionalEvents.push(event)\n\n    return this\n  }\n\n  /**\n   * Adds any additional desired iCalendar property having the given key-value pair to the instance.\n   *\n   * @param {Alarm} alarm\n   * @returns {ICalendar}\n   */\n  public addProperty = (key: string, value: ICSPropertyValue): this => {\n    if (typeof value === 'object') {\n      this.properties.push(`BEGIN:${key}`)\n\n        for (const k in value) {\n          this.addProperty(k, value[k])\n        }\n\n        this.properties.push(`END:${key}`)\n    } else {\n      this.properties.push(`${key}:${value.toString()}`)\n    }\n\n    return this\n  }\n\n  /**\n   * Adds an alarm. Multiple different alarms may be added to a single instance.\n   *\n   * @param {Alarm} alarm\n   * @returns {ICalendar}\n   */\n  public addAlarm = (alarm: ICSAlarm): this => {\n    const value: ICSPropertyValue = {\n      ACTION: alarm.action\n    }\n\n    if (alarm.description) value.DESCRIPTION = ics.formatText(alarm.description)\n    if (alarm.summary) value.SUMMARY = ics.formatText(alarm.summary)\n    if (alarm.duration) value.DURATION = this.getAlarmDuration(alarm.duration)\n    if (alarm.repeat) value.REPEAT = alarm.repeat\n    if (alarm.attach) {\n      const key = alarm.attach.params\n        ? `ATTACH;${alarm.attach.params}`\n        : 'ATTACH'\n\n      value[key] = alarm.attach.url\n    }\n    if (alarm.trigger instanceof Date) {\n      value['TRIGGER;VALUE=DATE-TIME'] = time.formatDate(alarm.trigger, FORMAT.FULL)\n    } else {\n      value['TRIGGER'] = this.getAlarmDuration(alarm.trigger)\n    }\n\n    return this.addProperty('VALARM', value)\n  }\n\n  /**\n   * Generates the iCalendar data.\n   *\n   * @returns {string}\n   */\n  public render = (): string => {\n    const events = [\n      this,\n      ...this.additionalEvents\n    ]\n\n    const vEvents = events.reduce((properties: string[], calendar: ICalendar) => [\n      ...properties,\n      'BEGIN:VEVENT',\n      ...calendar.properties,\n      ...calendar.getMeta(),\n      'END:VEVENT'\n    ], [])\n\n    return [\n      'BEGIN:VCALENDAR',\n      'VERSION:2.0',\n      ...vEvents,\n      `PRODID:${ics.getProdId()}`,\n      'END:VCALENDAR'\n    ].join('\\n')\n  }\n}\n"],"names":["FORMAT","URL","YAHOO","GOOGLE","OUTLOOK","addLeadingZero","n","parseInt","toString","slice","formatDate","d","format","Date","dateValues","YYYY","getUTCFullYear","MM","getUTCMonth","DD","getUTCDate","hh","getUTCHours","mm","getUTCMinutes","ss","getUTCSeconds","Object","keys","reduce","date","key","replace","time","start","end","seconds","Math","floor","hours","mins","concat","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","dateInput","days","additionalTime","newDate","setTime","getTime","CalendarBase","options","_this","this","isAllDay","description","title","location","params","attendees","setText","setTimestamps","recurrence","setParam","value","setAttendees","prototype","Array","isArray","extendStatics","b","setPrototypeOf","__proto__","p","hasOwnProperty","call","__extends","TypeError","String","__","constructor","create","__assign","assign","t","s","i","arguments","length","apply","__spreadArray","to","from","pack","ar","l","toParamString","delimiter","transformFn","paramString","undefined","push","join","data","filteredParams","filter","k","_a","encodeURIComponent","map","email","name","ics","str","random","substr","window","host","rrule","FREQ","frequency","INTERVAL","interval","COUNT","_b","count","WKST","weekstart","BYDAY","weekdays","BYMONTHDAY","monthdays","UNTIL","GoogleCalendar","_super","opts","setInitialParams","timestampFormat","dates","render","baseUrl","queryString","YahooCalendar","setTimeParams","OutlookCalendar","setHost","includes","ICalendar","additionalEvents","properties","meta","setMeta","addProperty","forEach","icsOptions","getAttendeeParams","mailto","delegatedFrom","partStat","role","sentBy","rsvp","getAlarmDuration","duration","features","weeks","minutes","exec","unshift","after","getMeta","addEvent","event","addAlarm","alarm","ACTION","action","DESCRIPTION","summary","SUMMARY","DURATION","repeat","REPEAT","attach","url","trigger","vEvents","calendar"],"mappings":"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"}