var G=Object.defineProperty;var H=(e,s,t)=>s in e?G(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t;var a=(e,s,t)=>(H(e,typeof s!="symbol"?s+"":s,t),t);import x from"./ConfigObject.6c1d73b3.js";import K from"./Basics.ca94c210.js";import q from"./Dates.c617ebbf.js";import Q from"./Recurrence.82f26b87.js";import{f as W,g as Y,h as I,_ as Z,r as L,o as P,c as S,e as U,i as $,v as j,b as d,j as X,k as z,F as J,l as tt,d as C,t as k}from"./app.2e23a6dc.js";import"./Months.bc08f21e.js";import"./Nth.00967a32.js";import"./Plural.f8315e75.js";import"./Row.2234aab9.js";import"./Weekdays.15f54879.js";var v=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},F={exports:{}};(function(e,s){(function(t,n){n()})(v,function(){function t(o,i){return typeof i>"u"?i={autoBom:!1}:typeof i!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(o.type)?new Blob(["\uFEFF",o],{type:o.type}):o}function n(o,i,c){var l=new XMLHttpRequest;l.open("GET",o),l.responseType="blob",l.onload=function(){D(l.response,i,c)},l.onerror=function(){console.error("could not download file")},l.send()}function r(o){var i=new XMLHttpRequest;i.open("HEAD",o,!1);try{i.send()}catch{}return 200<=i.status&&299>=i.status}function m(o){try{o.dispatchEvent(new MouseEvent("click"))}catch{var i=document.createEvent("MouseEvents");i.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),o.dispatchEvent(i)}}var h=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof v=="object"&&v.global===v?v:void 0,A=h.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),D=h.saveAs||(typeof window!="object"||window!==h?function(){}:"download"in HTMLAnchorElement.prototype&&!A?function(o,i,c){var l=h.URL||h.webkitURL,p=document.createElement("a");i=i||o.name||"download",p.download=i,p.rel="noopener",typeof o=="string"?(p.href=o,p.origin===location.origin?m(p):r(p.href)?n(o,i,c):m(p,p.target="_blank")):(p.href=l.createObjectURL(o),setTimeout(function(){l.revokeObjectURL(p.href)},4e4),setTimeout(function(){m(p)},0))}:"msSaveOrOpenBlob"in navigator?function(o,i,c){if(i=i||o.name||"download",typeof o!="string")navigator.msSaveOrOpenBlob(t(o,c),i);else if(r(o))n(o,i,c);else{var l=document.createElement("a");l.href=o,l.target="_blank",setTimeout(function(){m(l)})}}:function(o,i,c,l){if(l=l||open("","_blank"),l&&(l.document.title=l.document.body.innerText="downloading..."),typeof o=="string")return n(o,i,c);var p=o.type==="application/octet-stream",B=/constructor/i.test(h.HTMLElement)||h.safari,N=/CriOS\/[\d]+/.test(navigator.userAgent);if((N||p&&B||A)&&typeof FileReader<"u"){var M=new FileReader;M.onloadend=function(){var y=M.result;y=N?y:y.replace(/^data:[^;]*;/,"data:attachment/file;"),l?l.location.href=y:location=y,l=null},M.readAsDataURL(o)}else{var _=h.URL||h.webkitURL,w=_.createObjectURL(o);l?l.location=w:location.href=w,l=null,setTimeout(function(){_.revokeObjectURL(w)},4e4)}});h.saveAs=D.saveAs=D,e.exports=D})})(F);const et={FREQUENCY:{DAILY:"DAILY",WEEKLY:"WEEKLY",MONTHLY:"MONTHLY",YEARLY:"YEARLY"}},f={DATE:"YYYYMMDD",TIME:"ThhmmssZ",FULL:"YYYYMMDDThhmmssZ",NO_UTC_FULL:"YYYYMMDDThhmmss",OUTLOOK_DATE:"YYYY-MM-DD",OUTLOOK_TIME:"Thh:mm:ssZ",OUTLOOK_FULL:"YYYY-MM-DDThh:mm:ssZ"},O={YAHOO:"https://calendar.yahoo.com/",GOOGLE:"https://calendar.google.com/calendar/render",OUTLOOK:"https://outlook.{{host}}.com/calendar/0/deeplink/compose"},T=(e="")=>`0${parseInt(e.toString(),10)}`.slice(-2),st=(e,s)=>{const t=Math.floor((s-e)/1e3),n=Math.floor(t/3600),r=t/3600%1*60;return`${T(n)}${T(r)}`},nt=(e,s)=>{const t=Math.floor((s-e)/1e3);return Math.floor(t/3600)},rt=e=>{const{frequency:s,interval:t}=e,{FREQUENCY:n}=et;if(t)switch(s){case n.YEARLY:return t*365.25;case n.MONTHLY:return t*30.42;case n.WEEKLY:return t*7;default:return t}return 365.25*100},V=(e=new Date,s)=>{const t={YYYY:e.getUTCFullYear(),MM:T(e.getUTCMonth()+1),DD:T(e.getUTCDate()),hh:T(e.getUTCHours()),mm:T(e.getUTCMinutes()),ss:T(e.getUTCSeconds())};return Object.keys(t).reduce((n,r)=>n.replace(r,t[r].toString()),s)},ot=(e=new Date,s)=>{const t={YYYY:e.getFullYear(),MM:T(e.getMonth()+1),DD:T(e.getDate()),hh:T(e.getHours()),mm:T(e.getMinutes()),ss:T(e.getSeconds())};return Object.keys(t).reduce((n,r)=>n.replace(r,t[r].toString()),s)},at=()=>V(new Date,f.FULL),it=(e,s)=>{const t=s*864e5,n=new Date;return n.setTime(e.getTime()+t),n},u={addLeadingZero:T,getDuration:st,getHoursDiff:nt,getRecurrenceLengthDays:rt,formatDate:V,formatDateNoUtc:ot,getTimeCreated:at,incrementDate:it};class R{constructor(s){a(this,"isAllDay",!1);a(this,"description","");a(this,"title","");a(this,"location","");a(this,"start",new Date);a(this,"end",new Date);a(this,"recurrence");a(this,"params",{});a(this,"attendees",[]);a(this,"setText",s=>{this.description=s.description||"",this.title=s.title||"",this.location=s.location||""});a(this,"setTimestamps",s=>{this.isAllDay=!s.end,this.start=s.start,this.end=s.end||u.incrementDate(this.start,1),this.recurrence=s.recurrence});a(this,"setParam",(s,t)=>(this.params[s]=t,this));this.setText(s),this.setTimestamps(s),this.setAttendees(s)}setAttendees(s){this.attendees=Array.isArray(s.attendees)?s.attendees:[]}}const b=(e,s=";",t=n=>n)=>{const n=[];for(const r in e)e.hasOwnProperty(r)&&e[r]!==void 0&&n.push(`${r}=${t(e[r])}`);return n.join(s)},lt=e=>{const s=Object.keys(e).filter(t=>e[t]!==null).reduce((t,n)=>({...t,[n]:e[n]}),{});return b(s,"&",encodeURIComponent)},ct=e=>b(e,";"),dt=e=>e.map(({email:s,name:t})=>t?`${t} <${s}>`:s),ut=e=>[e[0].toUpperCase(),e.slice(-e.length+1).toLowerCase()].join(""),E={toParamString:b,toQueryString:lt,toIcsParamString:ct,toMailtoList:dt,toProperCase:ut},ht=(e="")=>e.replace(/\\/g,"\\\\").replace(/\n/g,"\\n").replace(/[,;]/g,"\\$&"),mt=()=>Math.random().toString(36).substr(2),ft=()=>typeof window<"u"?window.location.host:"datebook",pt=e=>{var t,n;const s={FREQ:e.frequency,INTERVAL:(t=e.interval)==null?void 0:t.toString(),COUNT:(n=e.count)==null?void 0:n.toString(),WKST:e.weekstart,BYDAY:e.weekdays,BYMONTHDAY:e.monthdays};return e.end&&(s.UNTIL=u.formatDate(e.end,f.FULL)),E.toIcsParamString(s)},g={formatText:ht,getUid:mt,getProdId:ft,getRrule:pt};class Tt extends R{constructor(t){super(t);a(this,"setInitialParams",()=>{let t=f.DATE;this.isAllDay||(t+=f.TIME);const n=[u.formatDate(this.start,t),u.formatDate(this.end,t)].join("/");this.setParam("action","TEMPLATE").setParam("dates",n).setParam("text",this.title).setParam("details",this.description).setParam("location",this.location).setParam("allday",this.isAllDay.toString()),this.recurrence&&this.setParam("recur",`RRULE:${g.getRrule(this.recurrence)}`),this.attendees.length>0&&this.setParam("add",E.toMailtoList(this.attendees).join(","))});a(this,"render",()=>{const t=O.GOOGLE,n=E.toQueryString(this.params);return`${t}?${n}`});this.setInitialParams()}}class Dt extends R{constructor(t){super(t);a(this,"setInitialParams",()=>{this.setParam("v","60").setParam("title",this.title).setParam("desc",this.description).setParam("in_loc",this.location),this.setTimeParams(),this.attendees.length>0&&this.setParam("inv_list",E.toMailtoList(this.attendees).join(","))});a(this,"setTimeParams",()=>{this.isAllDay?this.setParam("dur","allday").setParam("st",u.formatDateNoUtc(this.start,f.DATE)):(this.setParam("st",u.formatDateNoUtc(this.start,f.NO_UTC_FULL)),u.getHoursDiff(this.start.getTime(),this.end.getTime())>99?this.setParam("et",u.formatDateNoUtc(this.end,f.NO_UTC_FULL)):this.setParam("dur",u.getDuration(this.start.getTime(),this.end.getTime())))});a(this,"render",()=>{const t=O.YAHOO,n=E.toQueryString(this.params);return`${t}?${n}`});this.setInitialParams()}}class gt extends R{constructor(t){super(t);a(this,"baseUrl",O.OUTLOOK);a(this,"setInitialParams",()=>{let t=f.OUTLOOK_DATE;this.isAllDay||(t+=f.OUTLOOK_TIME),this.setParam("rru","addevent").setParam("path","/calendar/action/compose").setParam("startdt",u.formatDate(this.start,t)).setParam("enddt",u.formatDate(this.end,t)).setParam("subject",this.title).setParam("body",this.description).setParam("location",this.location).setParam("allday",this.isAllDay.toString()),this.attendees.length>0&&this.setParam("to",E.toMailtoList(this.attendees).join(","))});a(this,"setHost",t=>(["live","office"].includes(t)&&(this.baseUrl=O.OUTLOOK.replace("{{host}}",t)),this));a(this,"render",()=>{const t=E.toQueryString(this.params);return`${this.baseUrl}?${t}`});this.setInitialParams(),this.setHost("live")}}class Et extends R{constructor(t){super(t);a(this,"additionalEvents",[]);a(this,"properties",[]);a(this,"meta",{});a(this,"setInitialParams",()=>{this.setMeta("UID",g.getUid()).setMeta("DTSTAMP",u.getTimeCreated()).addProperty("CLASS","PUBLIC").addProperty("DESCRIPTION",g.formatText(this.description)).addProperty("LOCATION",g.formatText(this.location)).addProperty("SUMMARY",g.formatText(this.title)).addProperty("TRANSP","TRANSPARENT"),this.isAllDay?this.addProperty("DTSTART;VALUE=DATE",u.formatDateNoUtc(this.start,f.DATE)).addProperty("DTEND;VALUE=DATE",u.formatDateNoUtc(u.incrementDate(this.start,1),f.DATE)):this.addProperty("DTSTART",u.formatDate(this.start,f.FULL)).addProperty("DTEND",u.formatDate(this.end,f.FULL)),this.recurrence&&this.addProperty("RRULE",g.getRrule(this.recurrence)),this.attendees.length>0&&this.attendees.forEach(({email:t,name:n,icsOptions:r={}})=>{const m=this.getAttendeeParams(r,n),h=`MAILTO:${t}`;this.addProperty(m,h)})});a(this,"getAttendeeParams",(t,n)=>{const r={};return n&&(r.CN=n),t.delegatedFrom&&(r["DELEGATED-FROM"]=t.delegatedFrom),t.partStat&&(r.PARTSTAT=t.partStat),t.role&&(r.ROLE=t.role),t.sentBy&&(r["SENT-BY"]=t.sentBy),r.RSVP=t.rsvp?"TRUE":"FALSE",`ATTENDEE;${E.toParamString(r,";")}`});a(this,"getAlarmDuration",t=>{const n=[`${t.weeks}W`,`${t.days}D`,`${t.hours}H`,`${t.minutes}M`,`${t.seconds}S`].filter(r=>/^[0-9]+[A-Z]$/.exec(r));return n.unshift(t.after?"PT":"-PT"),n.join("")});a(this,"getMeta",()=>Object.keys(this.meta).map(t=>`${t}:${this.meta[t]}`));a(this,"setMeta",(t,n)=>(this.meta[t]=n,this));a(this,"addEvent",t=>(this.additionalEvents.push(t),this));a(this,"addProperty",(t,n)=>{if(typeof n=="object"){this.properties.push(`BEGIN:${t}`);for(const r in n)this.addProperty(r,n[r]);this.properties.push(`END:${t}`)}else this.properties.push(`${t}:${n.toString()}`);return this});a(this,"addAlarm",t=>{const n={ACTION:t.action};if(t.description&&(n.DESCRIPTION=g.formatText(t.description)),t.summary&&(n.SUMMARY=g.formatText(t.summary)),t.duration&&(n.DURATION=this.getAlarmDuration(t.duration)),t.repeat&&(n.REPEAT=t.repeat),t.attach){const r=t.attach.params?`ATTACH;${t.attach.params}`:"ATTACH";n[r]=t.attach.url}return t.trigger instanceof Date?n["TRIGGER;VALUE=DATE-TIME"]=u.formatDate(t.trigger,f.FULL):n.TRIGGER=this.getAlarmDuration(t.trigger),this.addProperty("VALARM",n)});a(this,"render",()=>["BEGIN:VCALENDAR","VERSION:2.0",...[this,...this.additionalEvents].reduce((r,m)=>[...r,"BEGIN:VEVENT",...m.properties,...m.getMeta(),"END:VEVENT"],[]),`PRODID:${g.getProdId()}`,"END:VCALENDAR"].join(`
`));this.setInitialParams()}}const At=W({name:"Generator",components:{ConfigObject:x,Basics:K,Dates:q,Recurrence:Q},setup(){const e=Y({start:new Date,location:"",title:"",description:"",recurrence:{}}),s=Y(!0),t=Y(!0),n={Google:Tt,"Yahoo!":Dt,Outlook:gt},r=I(()=>Object.keys(n).reduce((D,o)=>({...D,[o]:new n[o](e.value).render()}),{})),m=I(()=>new Et(e.value));function h(){e.value.recurrence=t.value?{}:void 0}function A(){const D=new Blob([m.value.render()],{type:"text/calendar"});F.exports.saveAs(D,"Event.ics")}return{isAllDay:s,isRecurring:t,model:e,serviceUrls:r,ics:m,onRecurrenceChange:h,download:A}}});const yt=d("h2",null,"Event Details",-1),Lt=d("label",{for:"isAllDay"},"This is an all-day event",-1),vt=d("h2",null,"Recurrence",-1),Pt=d("label",{for:"recurs"},"This event repeats",-1),Ut=d("h2",null,"Result",-1),Ot=d("h3",null,"Calendar Service Links",-1),Rt=["href"],Mt=d("hr",null,null,-1),wt=d("h3",null,"iCalendar",-1),Yt=d("code",null,".ics",-1),St={class:"language-typescript"},Ct={class:"language-json"},bt=d("hr",null,null,-1),Nt=d("h3",null,"Datebook Config Object",-1);function _t(e,s,t,n,r,m){const h=L("basics"),A=L("dates"),D=L("recurrence"),o=L("external-link-icon"),i=L("config-object");return P(),S("div",null,[yt,U(h,{modelValue:e.model,"onUpdate:modelValue":s[0]||(s[0]=c=>e.model=c)},null,8,["modelValue"]),U(A,{modelValue:e.model,"onUpdate:modelValue":s[1]||(s[1]=c=>e.model=c),isAllDay:e.isAllDay},null,8,["modelValue","isAllDay"]),$(d("input",{"onUpdate:modelValue":s[2]||(s[2]=c=>e.isAllDay=c),type:"checkbox",id:"isAllDay",value:"true"},null,512),[[j,e.isAllDay]]),Lt,d("div",null,[vt,$(d("input",{"onUpdate:modelValue":s[3]||(s[3]=c=>e.isRecurring=c),type:"checkbox",id:"recurs",onChange:s[4]||(s[4]=(...c)=>e.onRecurrenceChange&&e.onRecurrenceChange(...c))},null,544),[[j,e.isRecurring]]),Pt]),e.model.recurrence?(P(),X(D,{key:0,modelValue:e.model.recurrence,"onUpdate:modelValue":s[5]||(s[5]=c=>e.model.recurrence=c),isAllDay:e.isAllDay},null,8,["modelValue","isAllDay"])):z("v-if",!0),Ut,d("div",null,[Ot,d("ul",null,[(P(!0),S(J,null,tt(e.serviceUrls,(c,l)=>(P(),S("li",{key:l},[d("a",{href:c,target:"_blank"},[C(k(l)+" Calendar ",1),U(o)],8,Rt)]))),128))])]),Mt,d("div",null,[wt,d("a",{onClick:s[6]||(s[6]=(...c)=>e.download&&e.download(...c))},[C(" Download "),Yt,C(" file ↓ ")]),d("div",St,[d("pre",Ct,k(e.ics.render()),1)])]),bt,d("div",null,[Nt,U(i,{value:e.model},null,8,["value"])])])}const qt=Z(At,[["render",_t],["__file","Generator.vue"]]);export{qt as default};
